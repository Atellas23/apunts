install.packages(emmeans)
install.packages("emmeans")
install.packages("tables")
install.packages("RcmdrMisc")
install.packages("multcompView")
knitr::opts_chunk$set(echo = TRUE)
# e) traient la inreracció per simplificar el model
mv2<-lm(V~M+C,dd)
knitr::opts_chunk$set(echo = TRUE)
#setwd("...")
#options(contrasts = c("contr.sum", "contr.treatment"))
library(emmeans)
library(car)
dd <- read.csv2("../data/comrect.csv")
head(dd)
is.factor(dd$M)
dd$M<-as.factor(dd$M)
##############################################################################
# DESCRIPTIVA
scatterplot(V~C|M,smooth=F,data=dd)
##############################################################################
m0<-lm(V~1,dd)
mv<-lm(V~M+C+M:C,dd)
#mv<-lm(V~M*C,dd)
emmip(mv,M~C,CIs=T,at=list(C=c(90,105,120)))
summary(mv)
#Test omnibus
anova(m0,mv)
# Tests anova
Anova(mv)
# Diagnòstics
plot(predict(mv),resid(mv),pch=3,main="V Model factorial")
abline(h=0,lty=2)
#Valors estranys
plot(rstudent(mv),pch=3,main="V Model factorial")
abline(h=c(-3,-2,0,2,3),lty=2)
# Iguals vs diferents
anova(lm(V~C,dd),mv)
# Iguals vs paral·leles diferente
anova(lm(V~C,dd),lm(V~C+M,dd))
# En algun punt prop del centre de les C, les E[V] són diferents?
pairs(emmeans(mv,~M|C))
anova(lm(V~M+C,dd),mv)
Anova(mv)
# Separació dels pendents
(emmp<-emtrends(mv,~M,var="C"))
pairs(emmp)
#CLD(emmp)
anova(lm(V~C+M:C,dd),mv)
pairs(emmeans(mv,~M|C,at=list(C=0)))
(emm<-emmeans(mv,~M|C,at=list(C=c(90,105,120))))
pairs(emm)
#CLD(emm)
# e) traient la inreracció per simplificar el model
mv2<-lm(V~M+C,dd)
emmip(mv2,M~C,CIs=T,at=list(C=c(90,105,120)))
summary(mv2)
anova(m0,mv2)
Anova(mv2)
plot(predict(mv2),resid(mv2),pch=3,main="V Model additiu")
abline(h=0,lty=2)
plot(rstudent(mv2),pch=3,main="V Model additiu")
abline(h=c(-3,-2,0,2,3),lty=2)
# Resposta a c)
anova(lm(V~C,dd),mv2)
# Resposta a d)
(emm2<-emmeans(mv2,~M|C,at=list(C=c(90,105,120))))
pairs(emm2)
#CLD(emm2)
scatterplot(V~C|M,smooth=F,data=dd)
scatterplot(VV~C|M,smooth=F,data=dd)
scatterplot(V~C|M,smooth=F,data=dd)
scatterplot(VV~C|M,smooth=F,data=dd)
scatterplot(VV~C|M,smooth=F,data=dd)
m0<-lm(V~1,dd)
mv<-lm(V~M+C+M:C,dd)
#mv<-lm(V~M*C,dd)
emmip(mv,M~C,CIs=T,at=list(C=c(90,105,120)))
summary(mv)
#Test omnibus
anova(m0,mv)
# Tests anova
Anova(mv)
#Test omnibus
anova(m0,mv)
# Tests anova
# Anova(mv)
#Test omnibus
anova(m0,mv)
# Tests anova
Anova(mv)
? Anova
scatterplot(VV~C|M,smooth=F,data=dd)
m0<-lm(VV~1,dd)
mvv<-lm(VV~M+C+M:C,dd)
#mvv<-lm(VV~M*C,dd)
emmip(mvv,M~C,CIs=T,at=list(C=c(90,105,120)))
summary(mvv)
#Test omnibus
anova(m0,mvv)
# Tests anova
Anova(mvv,type=3)
#Test omnibus
anova(m0,mvv)
# Tests anova
Anova(mvv,type=2)
#Test omnibus
anova(m0,mvv)
# Tests anova
Anova(mvv,type=3)
#Test omnibus
anova(m0,mvv)
# Tests anova
Anova(mvv,type=2)
#Test omnibus
anova(m0,mvv)
# Tests anova
Anova(mvv)
knitr::opts_chunk$set(echo = TRUE)
#setwd("...")
#options(contrasts = c("contr.sum", "contr.treatment"))
library(emmeans)
library(car)
dd<-read.csv2("../data/area.csv")
head(dd)
library(RcmdrMisc)
library(tables)
##############################################################################
#DESCRIPTIVA
#cv<-function(x) {sd(x)/mean(x)}
#print(tabular(AREA*ESPECIE*COMPOST~((Dades=1)+(Mitjana=mean)+(Desv.tipus=sd)+(Coef.var.=cv)),dd),justification="r")
with(dd,plotMeans(AREA,ESPECIE,COMPOST,error.bars="none",level=0.95))
with(dd,plotMeans(AREA,COMPOST,ESPECIE,error.bars="none",level=0.95))
##############################################################################
# a) Model additiu
ma<-lm(AREA~ESPECIE+COMPOST,data=dd)
summary(ma)
emmip(ma,ESPECIE~COMPOST,CIs=T)
emmip(ma,COMPOST~ESPECIE,CIs=T)
m0<-lm(AREA~1,dd)
anova(m0,ma)
Anova(ma)
mf<-lm(AREA~ESPECIE*COMPOST,data=dd)
Anova(mf)
anova(ma,mf)
(emmf<-emmeans(ma,~ESPECIE+COMPOST))
pairs(emmf)
CLD(emmf)
plot(ma,which=1)
abline(h=0,lty=2)
with(dd,leveneTest(resid(ma),as.factor(paste(ESPECIE,COMPOST))))
# (extra) El mateix en el model factorial
mf<-lm(AREA~ESPECIE*COMPOST,data=dd)
plot(mf,which=1)
abline(h=0,lty=2)
with(dd,leveneTest(resid(mf),as.factor(paste(ESPECIE,COMPOST))))
